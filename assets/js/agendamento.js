function pegaMedidas(){$(".medida-form").html(),$.ajax({url:"agendamento/buscamedidas",success:function(a){for(var b=0;b<a.length;b++)$(".medida-form").append("<option value='"+a[b].idMedida+"'>"+a[b].qualidade+"-"+a[b].espessura+"-"+a[b].largura+"-"+a[b].comprimento+"</option>")}})}function verificaDados(){"Nenhuma"==horaEscolhida||0==horaInicial||0==horaFinal||"null"==localEscolhido?$("#btn-agendar").hide():$("#btn-agendar").show()}function formAdd(){$("tbody").append("<tr><td><input name='nmr_pacotes[]' class='form-control form-table-input' required></td><td><select name='medida[]' class='form-control form-table-input medida-form' required><option>Selecione uma</option></select></td><td><input name='pecas[]' class='form-control form-table-input' required></td><td><a onclick='formAdd();' class='btn btn-default btn-secondary'><span class='glyphicon glyphicon-plus'></span></a></td></tr><tr><td> &nbsp</td></tr>"),pegaMedidas()}function fechaBotoes(){horaEscolhida="Nenhuma";for(var a=0;a<24;a++)$("#"+a).removeClass("hora-importante")}function mostraHoras(){verificaDados(),$("#5").show(),$("#8").show(),$("#11").show(),$("#14").show(),$("#17").show(),$("#20").show(),$(".div-horas").show(),$(".div-horas-message").hide()}function escondeHoras(){verificaDados(),$("#5").hide(),$("#8").hide(),$("#11").hide(),$("#14").hide(),$("#17").hide(),$("#20").hide(),$(".div-horas").hide(),$(".div-horas-message").show()}function verificaData(){fechaBotoes();var a=$("#dateval"),b=["Domingo","Segunda-Feira","Terça-Feira","Quarta-Feira","Quinta-Feira","Sexta-Feira","Sábado"],c=a.val(),d=c.split("/").reverse(),e=new Date(d[0],d[1]-1,d[2]),f=e.getDay();b[f]==b[0]||b[f]==b[6]||"null"==localEscolhido?a.val(""):(""==localEscolhido&&escondeHoras(),data_convertida=convertData(c),$.ajax({url:"agendamento/buscahorario/"+data_convertida+"/"+localEscolhido,success:function(a){escondeDataLimite();for(var b=0;b<a.length;b++){var c=a[b].hora_entrega;$("#"+c).hide()}verificaDados()}}))}function convertData(a){var b=a.split("/");return b[0]+"-"+b[1]+"-"+b[2]}function limpaData(){$("#dateval").val(""),escondeHoras()}function escondeDataLimite(){horaInicial=$("#local").find(":selected").attr("data-init"),horaFinal=$("#local").find(":selected").attr("data-final"),fechaBotoes(),verificaDados(),mostraHoras(),localEscolhido=$("#local").val(),"null"==localEscolhido&&(escondeHoras(),horaEscolhida="Nenhuma"),console.log(horaInicial+" até "+horaFinal);for(var a=0;a<horaInicial;a++)$("#"+a).hide();for(var b=25;b>horaFinal;b--)$("#"+b).hide()}$("#dateval").datepicker({language:"pt-BR",daysOfWeekDisabled:"0,6",todayBtn:!0,todayHighlight:!0,calendarWeeks:!0,autoclose:!0});var horaEscolhida="Nenhuma",horaInicial=0,horaFinal=0,localEscolhido=0;verificaDados(),formAdd(),pegaMedidas(),escondeHoras(),$(".hora-aberta").click(function(){fechaBotoes(),horaEscolhida=$(this).attr("id"),$("#hora_form").val(horaEscolhida),$(this).addClass("hora-importante"),verificaDados()});